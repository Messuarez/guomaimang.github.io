import{_ as n,f as a}from"./app.fc756588.js";const s={},p=a(`<h1 id="joining-data-with-pandas" tabindex="-1"><a class="header-anchor" href="#joining-data-with-pandas" aria-hidden="true">#</a> Joining Data with pandas</h1><p>\u4F5C\u8005\uFF1A\u97E9\u4F73\u660E</p><p>\u672A\u7ECF\u8BB8\u53EF\uFF0C\u7981\u6B62\u8F6C\u8F7D\uFF0C\u5DF2\u505A\u7248\u6743\u5B58\u8BC1</p><hr><ul><li>Tables = DataFrames</li><li>Merging = Joining</li></ul><h2 id="inner-join" tabindex="-1"><a class="header-anchor" href="#inner-join" aria-hidden="true">#</a> Inner join</h2><img src="https://pic.hanjiaming.com.cn/2022/02/03/443f1ec136655.png" alt="1643835100715.png" style="zoom:25%;"><p>\u6307\u5B9A\u68C0\u67E5\u5217\uFF0C\u5C06\u6570\u636E\uFF08\u6216pair\uFF09\u76F8\u540C\u7684\u884C\u8FDB\u884C\u8FDE\u63A5\u5E76\u4FDD\u7559\u3002</p><p><img src="https://pic.hanjiaming.com.cn/2022/02/03/812d4308c5135.png" alt="1643834981023.png" loading="lazy"></p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>wards_census <span class="token operator">=</span> wards<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>census<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;ward&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>wards_census<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://pic.hanjiaming.com.cn/2022/02/03/69b14c0e2ed60.png" alt="1643835047555.png" loading="lazy"></p><h2 id="suffixes" tabindex="-1"><a class="header-anchor" href="#suffixes" aria-hidden="true">#</a> Suffixes</h2><p><img src="https://pic.hanjiaming.com.cn/2022/02/03/840fac9cdcc80.png" alt="1643835285745.png" loading="lazy"></p><p>\u7528\u4E8E\u7ED9\u76F8\u540C\u7684\u5217\u540D\u79F0\u52A0\u4E0A\u81EA\u5B9A\u4E49\u540E\u7F00\u4EE5\u533A\u5206\u3002</p><p><img src="https://pic.hanjiaming.com.cn/2022/02/03/aacae5f5bb6c0.png" alt="1643835216850.png" loading="lazy"></p><h2 id="left-join" tabindex="-1"><a class="header-anchor" href="#left-join" aria-hidden="true">#</a> Left Join</h2><p>\u5DE6\u4FA7\u6570\u636E\u5168\u90E8\u4FDD\u7559\uFF0C\u5C06\u53F3\u4FA7\u6570\u636E\u8FDE\u63A5\u5230\u5DE6\u4FA7\u3002</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>wards_census <span class="token operator">=</span> wards<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>census<span class="token punctuation">,</span>how <span class="token operator">=</span> <span class="token string">&quot;left&quot;</span><span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;ward&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><img src="https://pic.hanjiaming.com.cn/2022/02/03/1333c517c6827.png" alt="1643836148052.png" style="zoom:50%;"><img src="https://pic.hanjiaming.com.cn/2022/02/03/21ad295fc8b2d.png" alt="1643836056187.png" style="zoom:50%;"><p>right join \u5219\u53CD\u4E4B</p><img src="https://pic.hanjiaming.com.cn/2022/02/03/e0f3a698c0247.png" alt="CleanShot 2022-02-03 at 05.09.26@2x.png" style="zoom:50%;"><h3 id="merging-a-table-to-itself" tabindex="-1"><a class="header-anchor" href="#merging-a-table-to-itself" aria-hidden="true">#</a> Merging a table to itself</h3><p>Merging a table to itself with left join</p><p><img src="https://pic.hanjiaming.com.cn/2022/02/03/446fffe656d0c.png" alt="1643836656871.png" loading="lazy"></p><h2 id="outer-join" tabindex="-1"><a class="header-anchor" href="#outer-join" aria-hidden="true">#</a> Outer join</h2><img src="https://pic.hanjiaming.com.cn/2022/02/03/fdc2972e2480f.png" alt="1643836228510.png" style="zoom:50%;"><p>\u5C06\u5DE6\u53F3\u8FDB\u884C\u8FDE\u63A5\uFF0C\u5E76\u4FDD\u7559\u6CA1\u6709\u88AB\u8FDE\u63A5\u7684\u884C\u3002</p><p><img src="https://pic.hanjiaming.com.cn/2022/02/03/f1bf80262bc7a.png" alt="1643836325823.png" loading="lazy"></p><h2 id="\u81EA\u5B9A\u4E49\u68C0\u67E5\u5217" tabindex="-1"><a class="header-anchor" href="#\u81EA\u5B9A\u4E49\u68C0\u67E5\u5217" aria-hidden="true">#</a> \u81EA\u5B9A\u4E49\u68C0\u67E5\u5217</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>original_sequels <span class="token operator">=</span> sequels<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>sequels<span class="token punctuation">,</span> left_on<span class="token operator">=</span><span class="token string">&#39;sequel&#39;</span><span class="token punctuation">,</span> right_on<span class="token operator">=</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">,</span> suffixes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">&#39;_org&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;_seq&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="merge-ordered" tabindex="-1"><a class="header-anchor" href="#merge-ordered" aria-hidden="true">#</a> merge_ordered()</h2><h3 id="\u5BF9\u6BD4" tabindex="-1"><a class="header-anchor" href="#\u5BF9\u6BD4" aria-hidden="true">#</a> \u5BF9\u6BD4</h3><p><img src="https://pic.hanjiaming.com.cn/2022/02/03/5c5964f95ec59.png" alt="1643838808744.png" loading="lazy"></p><p>\u6CE8\u610F \u9ED8\u8BA4\u7684\u8FDE\u63A5\u65B9\u6CD5\u662Fouter join</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>pd<span class="token punctuation">.</span>merge_ordered<span class="token punctuation">(</span>appl<span class="token punctuation">,</span> mcd<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">,</span> suffixes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">&#39;_aapl&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;_mcd&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fill_method<span class="token operator">=</span><span class="token string">&#39;ffill&#39;</span><span class="token punctuation">)</span> <span class="token comment"># \u6307\u5B9A\u7A7A\u6570\u636E\u662F\u7528\u524D\u4E00\u4E2A\u503C</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="https://pic.hanjiaming.com.cn/2022/02/03/c0f11351a6077.png" alt="1643838945816.png" loading="lazy"></p><h2 id="merge-asof" tabindex="-1"><a class="header-anchor" href="#merge-asof" aria-hidden="true">#</a> merge_asof()</h2><ul><li>Similar to a merge_ordered() <strong>left join</strong></li><li>Similar features as merge_ordered()</li><li>\u975E\u7CBE\u51C6\u5339\u914D</li><li>merge \u7684 on \u7684 column \u5FC5\u987B\u662F\u5DF2\u7ECF\u6392\u597D\u5E8F\u7684</li><li>direction \u9ED8\u8BA4\u662F backward</li></ul><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>pd<span class="token punctuation">.</span>merge_asof<span class="token punctuation">(</span>visa<span class="token punctuation">,</span> ibm<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;date_time&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>suffixes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">&#39;_visa&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;_ibm&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>direction<span class="token operator">=</span><span class="token string">&#39;forward&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># \u5339\u914D\u53F3\u8FB9\u4E2D\u4E0D\u5927\u4E8E\u5DE6\u8FB9\u4E14\u6700\u63A5\u8FD1\u5DE6\u8FB9</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://pic.hanjiaming.com.cn/2022/02/03/cd870c6068163.png" alt="1643839163865.png" loading="lazy"></p><h2 id="\u53D8\u4F53\u5E94\u7528" tabindex="-1"><a class="header-anchor" href="#\u53D8\u4F53\u5E94\u7528" aria-hidden="true">#</a> \u53D8\u4F53\u5E94\u7528</h2><h3 id="semi-join" tabindex="-1"><a class="header-anchor" href="#semi-join" aria-hidden="true">#</a> semi-join</h3><img src="https://pic.hanjiaming.com.cn/2022/02/03/16a6c08f7cbee.png" alt="1643837527273.png" style="zoom:50%;"><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>genres_tracks <span class="token operator">=</span> genres<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>top_tracks<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">&#39;gid&#39;</span><span class="token punctuation">)</span>
top_genres <span class="token operator">=</span> genres<span class="token punctuation">[</span>genres<span class="token punctuation">[</span><span class="token string">&#39;gid&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span>genres_tracks<span class="token punctuation">[</span><span class="token string">&#39;gid&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>top_genres<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="anti-join" tabindex="-1"><a class="header-anchor" href="#anti-join" aria-hidden="true">#</a> anti-join</h3><p><img src="https://pic.hanjiaming.com.cn/2022/02/03/3b788bbdaa1c9.png" alt="1643837583407.png" loading="lazy"></p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>genres_tracks <span class="token operator">=</span> genres<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>top_tracks<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">&#39;gid&#39;</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">,</span> indicator<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
gid_list <span class="token operator">=</span> genres_tracks<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>genres_tracks<span class="token punctuation">[</span><span class="token string">&#39;_merge&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&#39;left_only&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;gid&#39;</span><span class="token punctuation">]</span>
non_top_genres <span class="token operator">=</span> genres<span class="token punctuation">[</span>genres<span class="token punctuation">[</span><span class="token string">&#39;gid&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span>gid_list<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>non_top_genres<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="concatenate-vertically" tabindex="-1"><a class="header-anchor" href="#concatenate-vertically" aria-hidden="true">#</a> Concatenate vertically</h2><p><strong>\u5782\u76F4\u62FC\u63A5</strong></p><p><img src="https://pic.hanjiaming.com.cn/2022/02/03/3a50db8e6e9f1.png" alt="1643837717984.png" loading="lazy"></p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>inv_jan<span class="token punctuation">,</span> inv_feb<span class="token punctuation">,</span> inv_mar<span class="token punctuation">]</span><span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><img src="https://pic.hanjiaming.com.cn/2022/02/03/1aeace29d36cf.png" alt="1643837798141.png" style="zoom:33%;"><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>inv_jan<span class="token punctuation">,</span> inv_feb<span class="token punctuation">,</span> inv_mar<span class="token punctuation">]</span><span class="token punctuation">,</span>ignore_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;jan&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;feb&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;mar&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><img src="https://pic.hanjiaming.com.cn/2022/02/03/d556e8076db72.png" alt="1643837892698.png" style="zoom:33%;"><h3 id="sort" tabindex="-1"><a class="header-anchor" href="#sort" aria-hidden="true">#</a> sort</h3><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>inv_jan<span class="token punctuation">,</span> inv_feb<span class="token punctuation">]</span><span class="token punctuation">,</span> sort<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="\u62FC\u63A5\u4FDD\u7559\u5217" tabindex="-1"><a class="header-anchor" href="#\u62FC\u63A5\u4FDD\u7559\u5217" aria-hidden="true">#</a> \u62FC\u63A5\u4FDD\u7559\u5217</h3><p>\u6307\u5B9A\u53C2\u6570 join\uFF0C\u9ED8\u8BA4 \u4EC5\u62FC\u63A5\u5171\u540C\u540D\u79F0\u7684\u5217\uFF0C</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>inv_jan<span class="token punctuation">,</span> inv_feb<span class="token punctuation">]</span><span class="token punctuation">,</span> join<span class="token operator">=</span><span class="token string">&#39;inner&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="\u4F7F\u7528-append-\u4EE3\u66FFconcat" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528-append-\u4EE3\u66FFconcat" aria-hidden="true">#</a> \u4F7F\u7528 append \u4EE3\u66FFconcat</h3><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>inv_jan<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>inv_feb<span class="token punctuation">,</span> inv_mar<span class="token punctuation">]</span><span class="token punctuation">,</span>ignore_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>sort<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="\u6709\u6761\u4EF6\u7684\u8FDE\u63A5" tabindex="-1"><a class="header-anchor" href="#\u6709\u6761\u4EF6\u7684\u8FDE\u63A5" aria-hidden="true">#</a> \u6709\u6761\u4EF6\u7684\u8FDE\u63A5</h2><p>\u9002\u7528\u4E8E\u6A2A\u5411 join\u548C\u5782\u76F4\u7684\u62FC\u63A5</p><h3 id="\u4E3A\u4EC0\u4E48\u8981\u6709\u6761\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u4E3A\u4EC0\u4E48\u8981\u6709\u6761\u4EF6" aria-hidden="true">#</a> \u4E3A\u4EC0\u4E48\u8981\u6709\u6761\u4EF6</h3><p><img src="https://pic.hanjiaming.com.cn/2022/02/03/f4aaf381ef6e3.png" alt="1643838478347.png" loading="lazy"></p><p>Why:</p><ul><li>Real world data is often NOT clean</li></ul><p>What to do:</p><ul><li>Fix incorrect data</li><li>Drop duplicate rows</li></ul><h3 id="\u6761\u4EF6\u53C2\u6570" tabindex="-1"><a class="header-anchor" href="#\u6761\u4EF6\u53C2\u6570" aria-hidden="true">#</a> \u6761\u4EF6\u53C2\u6570</h3><p>Checks if merge is of specied type</p><ul><li>&#39;one_to_one&#39;</li><li>&#39;one_to_many&#39;</li><li>&#39;many_to_one&#39;</li><li>&#39;many_to_many&#39;</li></ul><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token punctuation">.</span>merge<span class="token punctuation">(</span>validate<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>\u5373\u8FDE\u63A5\u524D\u5148\u68C0\u67E5\u662F\u5426\u7B26\u5408\u6761\u4EF6\uFF0C\u7B26\u5408\u6761\u4EF6\u624D\u4F1A\u8FDE\u63A5\uFF0C\u4E0D\u7B26\u5408\u5C31\u4E0D\u8FDE\u63A5\u3002</p>`,75);function e(t,o){return p}var i=n(s,[["render",e]]);export{i as default};
